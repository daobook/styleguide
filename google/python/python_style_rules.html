<!doctype html>
<html class="no-js" lang="zh_CN">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<link rel="author" title="关于这些文档" href="../../about.html" /><link rel="index" title="索引" href="../../genindex.html" /><link rel="search" title="搜索" href="../../search.html" /><link rel="next" title="4. 临别赠言" href="parting_words.html" /><link rel="prev" title="2. Python语言规范" href="python_language_rules.html" />

    <meta name="generator" content="sphinx-4.3.0, furo 2021.11.16"/>
        <title>3. Python 风格规范 - Style Guide 0.0.1 文档</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?digest=916d6ed8f59335acffa15474ff504849343d4c76" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-bootstrap.5fd3999ee7762ccc51105388f4a9d115.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?digest=0af69da206d614734f649b27d4cdc2dd6c31f41d" />
    <link rel="stylesheet" type="text/css" href="../../_static/default.css" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  body[data-theme="dark"] {
    --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
  }
  @media (prefers-color-scheme: dark) {
    body:not([data-theme="light"]) {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
  }
</style></head>
  <body>
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" />
      <line x1="4" y1="6" x2="20" y2="6" />
      <line x1="10" y1="12" x2="20" y2="12" />
      <line x1="6" y1="18" x2="20" y2="18" />
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">Style Guide 0.0.1 文档</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../index.html">
  
  
  <span class="sidebar-brand-text">Style Guide 0.0.1 文档</span>
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder=搜索 name="q" aria-label="搜索">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">导航</span></p>
<ul class="current">
<li class="toctree-l1 current has-children"><a class="reference internal" href="../index.html">谷歌风格指南</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="../cpp/index.html">C++ 风格指南</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../cpp/headers.html">1. 头文件</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cpp/scoping.html">2. 作用域</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cpp/classes.html">3. 类</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cpp/functions.html">4. 函数</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cpp/magic.html">5. 来自 Google 的奇技</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cpp/others.html">6. 其他 C++ 特性</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cpp/naming.html">7. 命名约定</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cpp/comments.html">8. 注释</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cpp/formatting.html">9. 格式</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cpp/exceptions.html">10. 规则特例</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cpp/end.html">11. 结束语</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cpp/changelog.html">12. 变更日志</a></li>
</ul>
</li>
<li class="toctree-l2 current has-children"><a class="reference internal" href="index.html">Python 风格指南 - 内容目录</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="background.html">1. 背景</a></li>
<li class="toctree-l3"><a class="reference internal" href="python_language_rules.html">2. Python语言规范</a></li>
<li class="toctree-l3 current current-page"><a class="current reference internal" href="#">3. Python 风格规范</a></li>
<li class="toctree-l3"><a class="reference internal" href="parting_words.html">4. 临别赠言</a></li>
<li class="toctree-l3"><a class="reference internal" href="changelog.html">5. 变更日志</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../html-css/index.html">HTML/CSS 风格指南</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../html-css/general/index.html">1. 通用</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../html-css/general/style-rules.html">1.1. 通用样式规则</a></li>
<li class="toctree-l4"><a class="reference internal" href="../html-css/general/formatting-rules.html">1.2. 通用排版规则</a></li>
<li class="toctree-l4"><a class="reference internal" href="../html-css/general/meta-rules.html">1.3. 通用文档级元数据规则</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../html-css/html/index.html">2. HTML</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../html-css/html/style-rules.html">2.1. HTML 样式规则</a></li>
<li class="toctree-l4"><a class="reference internal" href="../html-css/html/formatting-rules.html">2.2. HTML 格式规则</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../html-css/css/index.html">3. CSS</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../html-css/css/style-rules.html">3.1. CSS 样式规则</a></li>
<li class="toctree-l4"><a class="reference internal" href="../html-css/css/formatting-rules.html">3.2. CSS格式化规则</a></li>
<li class="toctree-l4"><a class="reference internal" href="../html-css/css/meta-rules.html">3.3. CSS 元数据规则</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../html-css/parting_words.html">4. 赠言</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../shell/index.html">Shell 风格指南 - 内容目录</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../shell/background.html">1. 背景</a></li>
<li class="toctree-l3"><a class="reference internal" href="../shell/shell_files_and_interpreter_invocation.html">2. Shell文件和解释器调用</a></li>
<li class="toctree-l3"><a class="reference internal" href="../shell/environment.html">3. 环境</a></li>
<li class="toctree-l3"><a class="reference internal" href="../shell/comments.html">4. 注释</a></li>
<li class="toctree-l3"><a class="reference internal" href="../shell/formatting.html">5. 格式</a></li>
<li class="toctree-l3"><a class="reference internal" href="../shell/features_and_bugs.html">6. 特性及错误</a></li>
<li class="toctree-l3"><a class="reference internal" href="../shell/naming_conventions.html">7. 命名约定</a></li>
<li class="toctree-l3"><a class="reference internal" href="../shell/calling_commands.html">8. 调用命令</a></li>
<li class="toctree-l3"><a class="reference internal" href="../shell/conclusion.html">9. 结论</a></li>
<li class="toctree-l3"><a class="reference internal" href="../shell/changelog.html">10. 变更日志</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../typescript/index.html">TypeScript 风格指南</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../typescript/syntax.html">1. 语法规范</a></li>
<li class="toctree-l3"><a class="reference internal" href="../typescript/language.html">2. 语言特性</a></li>
<li class="toctree-l3"><a class="reference internal" href="../typescript/source_organization.html">3. 代码管理</a></li>
<li class="toctree-l3"><a class="reference internal" href="../typescript/type_system.html">4. 类型系统</a></li>
<li class="toctree-l3"><a class="reference internal" href="../typescript/consistency.html">5. 一致性</a></li>
<li class="toctree-l3"><a class="reference internal" href="../typescript/changelog.html">6. 变更日志</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../javascript/index.html">Javascript 风格指南</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../javascript/background.html">1. 背景</a></li>
<li class="toctree-l3"><a class="reference internal" href="../javascript/javascript_language_rules.html">2. Javascript语言规范</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../about.html">关于</a></li>
</ul>

</div>
</div>
      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <div class="content-icon-container">
          <div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="python">
<h1><span class="section-number">3. </span>Python 风格规范<a class="headerlink" href="#python" title="永久链接至标题">¶</a></h1>
<section id="id1">
<h2><span class="section-number">3.1. </span>分号<a class="headerlink" href="#id1" title="永久链接至标题">¶</a></h2>
<div class="admonition tip">
<p class="admonition-title">小技巧</p>
<p>不要在行尾加分号, 也不要用分号将两条命令放在同一行.</p>
</div>
</section>
<section id="line-length">
<span id="id2"></span><h2><span class="section-number">3.2. </span>行长度<a class="headerlink" href="#line-length" title="永久链接至标题">¶</a></h2>
<div class="admonition tip">
<p class="admonition-title">小技巧</p>
<p>每行不超过80个字符</p>
</div>
<p>例外:</p>
<ol class="arabic">
<li><p>长的导入模块语句</p></li>
<li><p>注释里的URL,路径以及其他的一些长标记</p></li>
<li><p>不便于换行，不包含空格的模块级字符串常量，比如url或者路径</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Pylint 禁用注释.（例如：<cite># pylint: disable=invalid-name</cite> ）</p></li>
</ol>
</div></blockquote>
</li>
</ol>
<p>除非是在 <code class="docutils literal notranslate"><span class="pre">with</span></code> 语句需要三个以上的上下文管理器的情况下，否则不要使用反斜杠连接行.</p>
<p>Python会将 <a class="reference external" href="http://docs.python.org/2/reference/lexical_analysis.html#implicit-line-joining">圆括号, 中括号和花括号中的行隐式的连接起来</a> , 你可以利用这个特点. 如果需要, 你可以在表达式外围增加一对额外的圆括号.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Yes</span><span class="p">:</span> <span class="n">foo_bar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'black'</span><span class="p">,</span> <span class="n">design</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">'foo'</span><span class="p">,</span>
             <span class="n">emphasis</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">highlight</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

     <span class="k">if</span> <span class="p">(</span><span class="n">width</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">height</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span>
         <span class="n">color</span> <span class="o">==</span> <span class="s1">'red'</span> <span class="ow">and</span> <span class="n">emphasis</span> <span class="o">==</span> <span class="s1">'strong'</span><span class="p">):</span>
</pre></div>
</div>
<p>如果一个文本字符串在一行放不下, 可以使用圆括号来实现隐式行连接:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="s1">'This will build a very long long '</span>
     <span class="s1">'long long long long long long string'</span><span class="p">)</span>
</pre></div>
</div>
<p>在注释中，如果必要，将长的URL放在一行上。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Yes</span><span class="p">:</span>  <span class="c1"># See details at</span>
      <span class="c1"># http://www.example.com/us/developer/documentation/api/content/v2.0/csv_file_name_extension_full_specification.html</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">No</span><span class="p">:</span>  <span class="c1"># See details at</span>
     <span class="c1"># http://www.example.com/us/developer/documentation/api/content/\</span>
     <span class="c1"># v2.0/csv_file_name_extension_full_specification.html</span>
</pre></div>
</div>
<p>当 <code class="docutils literal notranslate"><span class="pre">with</span></code> 表达式需要使用三个及其以上的上下文管理器时，可以使用反斜杠换行.若只需要两个，请使用嵌套的with.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Yes</span><span class="p">:</span>  <span class="k">with</span> <span class="n">very_long_first_expression_function</span><span class="p">()</span> <span class="k">as</span> <span class="n">spam</span><span class="p">,</span> \
           <span class="n">very_long_second_expression_function</span><span class="p">()</span> <span class="k">as</span> <span class="n">beans</span><span class="p">,</span> \
           <span class="n">third_thing</span><span class="p">()</span> <span class="k">as</span> <span class="n">eggs</span><span class="p">:</span>
          <span class="n">place_order</span><span class="p">(</span><span class="n">eggs</span><span class="p">,</span> <span class="n">beans</span><span class="p">,</span> <span class="n">spam</span><span class="p">,</span> <span class="n">beans</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">No</span><span class="p">:</span>  <span class="k">with</span> <span class="n">VeryLongFirstExpressionFunction</span><span class="p">()</span> <span class="k">as</span> <span class="n">spam</span><span class="p">,</span> \
          <span class="n">VeryLongSecondExpressionFunction</span><span class="p">()</span> <span class="k">as</span> <span class="n">beans</span><span class="p">:</span>
       <span class="n">PlaceOrder</span><span class="p">(</span><span class="n">eggs</span><span class="p">,</span> <span class="n">beans</span><span class="p">,</span> <span class="n">spam</span><span class="p">,</span> <span class="n">beans</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Yes</span><span class="p">:</span>  <span class="k">with</span> <span class="n">very_long_first_expression_function</span><span class="p">()</span> <span class="k">as</span> <span class="n">spam</span><span class="p">:</span>
          <span class="k">with</span> <span class="n">very_long_second_expression_function</span><span class="p">()</span> <span class="k">as</span> <span class="n">beans</span><span class="p">:</span>
              <span class="n">place_order</span><span class="p">(</span><span class="n">beans</span><span class="p">,</span> <span class="n">spam</span><span class="p">)</span>
</pre></div>
</div>
<p>注意上面例子中的元素缩进; 你可以在本文的 <a class="reference internal" href="#indentation"><span class="std std-ref">缩进</span></a> 部分找到解释.</p>
<p>另外在其他所有情况下，若一行超过80个字符，但 <a class="reference external" href="https://github.com/google/yapf/">yapf</a> 却无法将该行字数降至80个字符以下时，则允许该行超过80个字符长度.</p>
</section>
<section id="id5">
<h2><span class="section-number">3.3. </span>括号<a class="headerlink" href="#id5" title="永久链接至标题">¶</a></h2>
<div class="admonition tip">
<p class="admonition-title">小技巧</p>
<p>宁缺毋滥的使用括号</p>
</div>
<p>除非是用于实现行连接, 否则不要在返回语句或条件语句中使用括号. 不过在元组两边使用括号是可以的.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Yes</span><span class="p">:</span> <span class="k">if</span> <span class="n">foo</span><span class="p">:</span>
         <span class="n">bar</span><span class="p">()</span>
       <span class="k">while</span> <span class="n">x</span><span class="p">:</span>
           <span class="n">x</span> <span class="o">=</span> <span class="n">bar</span><span class="p">()</span>
       <span class="k">if</span> <span class="n">x</span> <span class="ow">and</span> <span class="n">y</span><span class="p">:</span>
           <span class="n">bar</span><span class="p">()</span>
       <span class="k">if</span> <span class="ow">not</span> <span class="n">x</span><span class="p">:</span>
           <span class="n">bar</span><span class="p">()</span>
       <span class="c1"># For a 1 item tuple the ()s are more visually obvious than the comma.</span>
       <span class="n">onesie</span> <span class="o">=</span> <span class="p">(</span><span class="n">foo</span><span class="p">,)</span>
       <span class="k">return</span> <span class="n">foo</span>
       <span class="k">return</span> <span class="n">spam</span><span class="p">,</span> <span class="n">beans</span>
       <span class="k">return</span> <span class="p">(</span><span class="n">spam</span><span class="p">,</span> <span class="n">beans</span><span class="p">)</span>
       <span class="k">for</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span> <span class="o">...</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">No</span><span class="p">:</span>  <span class="k">if</span> <span class="p">(</span><span class="n">x</span><span class="p">):</span>
         <span class="n">bar</span><span class="p">()</span>
     <span class="k">if</span> <span class="ow">not</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
         <span class="n">bar</span><span class="p">()</span>
     <span class="k">return</span> <span class="p">(</span><span class="n">foo</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="indentation">
<span id="id6"></span><h2><span class="section-number">3.4. </span>缩进<a class="headerlink" href="#indentation" title="永久链接至标题">¶</a></h2>
<div class="admonition tip">
<p class="admonition-title">小技巧</p>
<p>用4个空格来缩进代码</p>
</div>
<p>绝对不要用tab, 也不要tab和空格混用. 对于行连接的情况, 你应该要么垂直对齐换行的元素(见 <a class="reference internal" href="#line-length"><span class="std std-ref">行长度</span></a> 部分的示例), 或者使用4空格的悬挂式缩进(这时第一行不应该有参数):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Yes</span><span class="p">:</span>   <span class="c1"># Aligned with opening delimiter</span>
       <span class="n">foo</span> <span class="o">=</span> <span class="n">long_function_name</span><span class="p">(</span><span class="n">var_one</span><span class="p">,</span> <span class="n">var_two</span><span class="p">,</span>
                                <span class="n">var_three</span><span class="p">,</span> <span class="n">var_four</span><span class="p">)</span>

       <span class="c1"># Aligned with opening delimiter in a dictionary</span>
       <span class="n">foo</span> <span class="o">=</span> <span class="p">{</span>
           <span class="n">long_dictionary_key</span><span class="p">:</span> <span class="n">value1</span> <span class="o">+</span>
                                <span class="n">value2</span><span class="p">,</span>
           <span class="o">...</span>
       <span class="p">}</span>

       <span class="c1"># 4-space hanging indent; nothing on first line</span>
       <span class="n">foo</span> <span class="o">=</span> <span class="n">long_function_name</span><span class="p">(</span>
           <span class="n">var_one</span><span class="p">,</span> <span class="n">var_two</span><span class="p">,</span> <span class="n">var_three</span><span class="p">,</span>
           <span class="n">var_four</span><span class="p">)</span>

       <span class="c1"># 4-space hanging indent in a dictionary</span>
       <span class="n">foo</span> <span class="o">=</span> <span class="p">{</span>
           <span class="n">long_dictionary_key</span><span class="p">:</span>
               <span class="n">long_dictionary_value</span><span class="p">,</span>
           <span class="o">...</span>
       <span class="p">}</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">No</span><span class="p">:</span>    <span class="c1"># Stuff on first line forbidden</span>
      <span class="n">foo</span> <span class="o">=</span> <span class="n">long_function_name</span><span class="p">(</span><span class="n">var_one</span><span class="p">,</span> <span class="n">var_two</span><span class="p">,</span>
          <span class="n">var_three</span><span class="p">,</span> <span class="n">var_four</span><span class="p">)</span>

      <span class="c1"># 2-space hanging indent forbidden</span>
      <span class="n">foo</span> <span class="o">=</span> <span class="n">long_function_name</span><span class="p">(</span>
        <span class="n">var_one</span><span class="p">,</span> <span class="n">var_two</span><span class="p">,</span> <span class="n">var_three</span><span class="p">,</span>
        <span class="n">var_four</span><span class="p">)</span>

      <span class="c1"># No hanging indent in a dictionary</span>
      <span class="n">foo</span> <span class="o">=</span> <span class="p">{</span>
          <span class="n">long_dictionary_key</span><span class="p">:</span>
              <span class="n">long_dictionary_value</span><span class="p">,</span>
              <span class="o">...</span>
      <span class="p">}</span>
</pre></div>
</div>
</section>
<section id="id7">
<h2><span class="section-number">3.5. </span>序列元素尾部逗号<a class="headerlink" href="#id7" title="永久链接至标题">¶</a></h2>
<div class="admonition tip">
<p class="admonition-title">小技巧</p>
<p>仅当 <code class="docutils literal notranslate"><span class="pre">]</span></code>, <code class="docutils literal notranslate"><span class="pre">)</span></code>, <code class="docutils literal notranslate"><span class="pre">}</span></code> 和末位元素不在同一行时，推荐使用序列元素尾部逗号. 当末位元素尾部有逗号时，元素后的逗号可以指示 <a class="reference external" href="https://pypi.org/project/yapf/">YAPF</a> 将序列格式化为每行一项.</p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Yes</span><span class="p">:</span>   <span class="n">golomb3</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="n">Yes</span><span class="p">:</span>   <span class="n">golomb4</span> <span class="o">=</span> <span class="p">[</span>
           <span class="mi">0</span><span class="p">,</span>
           <span class="mi">1</span><span class="p">,</span>
           <span class="mi">4</span><span class="p">,</span>
           <span class="mi">6</span><span class="p">,</span>
       <span class="p">]</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">No</span><span class="p">:</span>    <span class="n">golomb4</span> <span class="o">=</span> <span class="p">[</span>
           <span class="mi">0</span><span class="p">,</span>
           <span class="mi">1</span><span class="p">,</span>
           <span class="mi">4</span><span class="p">,</span>
           <span class="mi">6</span>
       <span class="p">]</span>
</pre></div>
</div>
</section>
<section id="id8">
<h2><span class="section-number">3.6. </span>空行<a class="headerlink" href="#id8" title="永久链接至标题">¶</a></h2>
<div class="admonition tip">
<p class="admonition-title">小技巧</p>
<p>顶级定义之间空两行, 方法定义之间空一行</p>
</div>
<p>顶级定义之间空两行, 比如函数或者类定义. 方法定义, 类定义与第一个方法之间, 都应该空一行. 函数或方法中, 某些地方要是你觉得合适, 就空一行.</p>
</section>
<section id="id9">
<h2><span class="section-number">3.7. </span>空格<a class="headerlink" href="#id9" title="永久链接至标题">¶</a></h2>
<div class="admonition tip">
<p class="admonition-title">小技巧</p>
<p>按照标准的排版规范来使用标点两边的空格</p>
</div>
<p>括号内不要有空格.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Yes</span><span class="p">:</span> <span class="n">spam</span><span class="p">(</span><span class="n">ham</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">{</span><span class="n">eggs</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="p">[])</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">No</span><span class="p">:</span>  <span class="n">spam</span><span class="p">(</span> <span class="n">ham</span><span class="p">[</span> <span class="mi">1</span> <span class="p">],</span> <span class="p">{</span> <span class="n">eggs</span><span class="p">:</span> <span class="mi">2</span> <span class="p">},</span> <span class="p">[</span> <span class="p">]</span> <span class="p">)</span>
</pre></div>
</div>
<p>不要在逗号, 分号, 冒号前面加空格, 但应该在它们后面加(除了在行尾).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Yes</span><span class="p">:</span> <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
         <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
     <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">No</span><span class="p">:</span>  <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">4</span> <span class="p">:</span>
         <span class="nb">print</span><span class="p">(</span><span class="n">x</span> <span class="p">,</span> <span class="n">y</span><span class="p">)</span>
     <span class="n">x</span> <span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">y</span> <span class="p">,</span> <span class="n">x</span>
</pre></div>
</div>
<p>参数列表, 索引或切片的左括号前不应加空格.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Yes</span><span class="p">:</span> <span class="n">spam</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">no</span><span class="p">:</span> <span class="n">spam</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Yes</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="s1">'key'</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">No</span><span class="p">:</span>  <span class="nb">dict</span> <span class="p">[</span><span class="s1">'key'</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span> <span class="p">[</span><span class="n">index</span><span class="p">]</span>
</pre></div>
</div>
<p>在二元操作符两边都加上一个空格, 比如赋值(=), 比较(==, &lt;, &gt;, !=, &lt;&gt;, &lt;=, &gt;=, in, not in, is, is not), 布尔(and, or, not).  至于算术操作符两边的空格该如何使用, 需要你自己好好判断. 不过两侧务必要保持一致.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Yes</span><span class="p">:</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">1</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">No</span><span class="p">:</span>  <span class="n">x</span><span class="o">&lt;</span><span class="mi">1</span>
</pre></div>
</div>
<p>当 <code class="docutils literal notranslate"><span class="pre">=</span></code> 用于指示关键字参数或默认参数值时, 不要在其两侧使用空格. 但若存在类型注释的时候,需要在 <code class="docutils literal notranslate"><span class="pre">=</span></code> 周围使用空格.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Yes</span><span class="p">:</span> <span class="k">def</span> <span class="nf">complex</span><span class="p">(</span><span class="n">real</span><span class="p">,</span> <span class="n">imag</span><span class="o">=</span><span class="mf">0.0</span><span class="p">):</span> <span class="k">return</span> <span class="n">magic</span><span class="p">(</span><span class="n">r</span><span class="o">=</span><span class="n">real</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="n">imag</span><span class="p">)</span>
<span class="n">Yes</span><span class="p">:</span> <span class="k">def</span> <span class="nf">complex</span><span class="p">(</span><span class="n">real</span><span class="p">,</span> <span class="n">imag</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">):</span> <span class="k">return</span> <span class="n">Magic</span><span class="p">(</span><span class="n">r</span><span class="o">=</span><span class="n">real</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="n">imag</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">No</span><span class="p">:</span>  <span class="k">def</span> <span class="nf">complex</span><span class="p">(</span><span class="n">real</span><span class="p">,</span> <span class="n">imag</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">):</span> <span class="k">return</span> <span class="n">magic</span><span class="p">(</span><span class="n">r</span> <span class="o">=</span> <span class="n">real</span><span class="p">,</span> <span class="n">i</span> <span class="o">=</span> <span class="n">imag</span><span class="p">)</span>
<span class="n">No</span><span class="p">:</span>  <span class="k">def</span> <span class="nf">complex</span><span class="p">(</span><span class="n">real</span><span class="p">,</span> <span class="n">imag</span><span class="p">:</span> <span class="nb">float</span><span class="o">=</span><span class="mf">0.0</span><span class="p">):</span> <span class="k">return</span> <span class="n">Magic</span><span class="p">(</span><span class="n">r</span> <span class="o">=</span> <span class="n">real</span><span class="p">,</span> <span class="n">i</span> <span class="o">=</span> <span class="n">imag</span><span class="p">)</span>
</pre></div>
</div>
<p>不要用空格来垂直对齐多行间的标记, 因为这会成为维护的负担(适用于:, #, =等):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Yes</span><span class="p">:</span>
     <span class="n">foo</span> <span class="o">=</span> <span class="mi">1000</span>  <span class="c1"># comment</span>
     <span class="n">long_name</span> <span class="o">=</span> <span class="mi">2</span>  <span class="c1"># comment that should not be aligned</span>

     <span class="n">dictionary</span> <span class="o">=</span> <span class="p">{</span>
         <span class="s2">"foo"</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
         <span class="s2">"long_name"</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
         <span class="p">}</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">No</span><span class="p">:</span>
     <span class="n">foo</span>       <span class="o">=</span> <span class="mi">1000</span>  <span class="c1"># comment</span>
     <span class="n">long_name</span> <span class="o">=</span> <span class="mi">2</span>     <span class="c1"># comment that should not be aligned</span>

     <span class="n">dictionary</span> <span class="o">=</span> <span class="p">{</span>
         <span class="s2">"foo"</span>      <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
         <span class="s2">"long_name"</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
         <span class="p">}</span>
</pre></div>
</div>
</section>
<section id="shebang">
<h2><span class="section-number">3.8. </span>Shebang<a class="headerlink" href="#shebang" title="永久链接至标题">¶</a></h2>
<div class="admonition tip">
<p class="admonition-title">小技巧</p>
<p>大部分.py文件不必以#!作为文件的开始. 根据 <a class="reference external" href="http://www.python.org/dev/peps/pep-0394/">PEP-394</a> , 程序的main文件应该以 <code class="docutils literal notranslate"><span class="pre">#!/usr/bin/python2</span></code> 或者 <code class="docutils literal notranslate"><span class="pre">#!/usr/bin/python3</span></code> 开始.</p>
</div>
<p>(译者注: 在计算机科学中, <a class="reference external" href="http://en.wikipedia.org/wiki/Shebang_(Unix)">Shebang</a> (也称为Hashbang)是一个由井号和叹号构成的字符串行(#!), 其出现在文本文件的第一行的前两个字符. 在文件中存在Shebang的情况下, 类Unix操作系统的程序载入器会分析Shebang后的内容, 将这些内容作为解释器指令, 并调用该指令, 并将载有Shebang的文件路径作为该解释器的参数. 例如, 以指令#!/bin/sh开头的文件在执行时会实际调用/bin/sh程序.)</p>
<p><code class="docutils literal notranslate"><span class="pre">#!</span></code> 先用于帮助内核找到Python解释器, 但是在导入模块时, 将会被忽略. 因此只有被直接执行的文件中才有必要加入 <code class="docutils literal notranslate"><span class="pre">#!</span></code> .</p>
</section>
<section id="comments">
<span id="id11"></span><h2><span class="section-number">3.9. </span>注释<a class="headerlink" href="#comments" title="永久链接至标题">¶</a></h2>
<div class="admonition tip">
<p class="admonition-title">小技巧</p>
<p>确保对模块, 函数, 方法和行内注释使用正确的风格</p>
</div>
<p><strong>文档字符串</strong></p>
<blockquote>
<div><p>Python有一种独一无二的的注释方式: 使用文档字符串. 文档字符串是包, 模块, 类或函数里的第一个语句. 这些字符串可以通过对象的 <code class="docutils literal notranslate"><span class="pre">__doc__</span></code> 成员被自动提取, 并且被pydoc所用. (你可以在你的模块上运行pydoc试一把, 看看它长什么样). 我们对文档字符串的惯例是使用三重双引号”””( <a class="reference external" href="http://www.python.org/dev/peps/pep-0257/">PEP-257</a> ). 一个文档字符串应该这样组织: 首先是一行以句号, 问号或惊叹号结尾的概述(或者该文档字符串单纯只有一行). 接着是一个空行. 接着是文档字符串剩下的部分, 它应该与文档字符串的第一行的第一个引号对齐. 下面有更多文档字符串的格式化规范.</p>
</div></blockquote>
<p><strong>模块</strong></p>
<blockquote>
<div><p>每个文件应该包含一个许可样板. 根据项目使用的许可(例如, Apache 2.0, BSD, LGPL, GPL), 选择合适的样板.
其开头应是对模块内容和用法的描述.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">"""A one line summary of the module or program, terminated by a period.</span>

<span class="sd">Leave one blank line.  The rest of this docstring should contain an</span>
<span class="sd">overall description of the module or program.  Optionally, it may also</span>
<span class="sd">contain a brief description of exported classes and functions and/or usage</span>
<span class="sd">examples.</span>

<span class="sd">Typical usage example:</span>

<span class="sd">foo = ClassFoo()</span>
<span class="sd">bar = foo.FunctionBar()</span>
<span class="sd">"""</span>
</pre></div>
</div>
<p><strong>函数和方法</strong></p>
<blockquote>
<div><p>下文所指的函数,包括函数, 方法, 以及生成器.</p>
<p>一个函数必须要有文档字符串, 除非它满足以下条件:</p>
<ol class="arabic simple">
<li><p>外部不可见</p></li>
<li><p>非常短小</p></li>
<li><p>简单明了</p></li>
</ol>
<p>文档字符串应该包含函数做什么, 以及输入和输出的详细描述. 通常, 不应该描述”怎么做”, 除非是一些复杂的算法. 文档字符串应该提供足够的信息, 当别人编写代码调用该函数时, 他不需要看一行代码, 只要看文档字符串就可以了. 对于复杂的代码, 在代码旁边加注释会比使用文档字符串更有意义.
覆盖基类的子类方法应有一个类似 <code class="docutils literal notranslate"><span class="pre">See</span> <span class="pre">base</span> <span class="pre">class</span></code> 的简单注释来指引读者到基类方法的文档注释.若重载的子类方法和基类方法有很大不同,那么注释中应该指明这些信息.</p>
<p>关于函数的几个方面应该在特定的小节中进行描述记录， 这几个方面如下文所述. 每节应该以一个标题行开始. 标题行以冒号结尾. 除标题行外, 节的其他内容应被缩进2个空格.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>列出每个参数的名字, 并在名字后使用一个冒号和一个空格, 分隔对该参数的描述.如果描述太长超过了单行80字符,使用2或者4个空格的悬挂缩进(与文件其他部分保持一致).
描述应该包括所需的类型和含义.
如果一个函数接受*foo(可变长度参数列表)或者**bar (任意关键字参数), 应该详细列出*foo和**bar.</p>
</dd>
<dt>Returns: (或者 Yields: 用于生成器)</dt><dd><p>描述返回值的类型和语义. 如果函数返回None, 这一部分可以省略.</p>
</dd>
<dt>Raises:</dt><dd><p>列出与接口有关的所有异常.</p>
</dd>
</dl>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">fetch_smalltable_rows</span><span class="p">(</span><span class="n">table_handle</span><span class="p">:</span> <span class="n">smalltable</span><span class="o">.</span><span class="n">Table</span><span class="p">,</span>
                        <span class="n">keys</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">bytes</span><span class="p">,</span> <span class="nb">str</span><span class="p">]],</span>
                        <span class="n">require_all_keys</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">bytes</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
    <span class="sd">"""Fetches rows from a Smalltable.</span>

<span class="sd">    Retrieves rows pertaining to the given keys from the Table instance</span>
<span class="sd">    represented by table_handle.  String keys will be UTF-8 encoded.</span>

<span class="sd">    Args:</span>
<span class="sd">        table_handle: An open smalltable.Table instance.</span>
<span class="sd">        keys: A sequence of strings representing the key of each table</span>
<span class="sd">        row to fetch.  String keys will be UTF-8 encoded.</span>
<span class="sd">        require_all_keys: Optional; If require_all_keys is True only</span>
<span class="sd">        rows with values set for all keys will be returned.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A dict mapping keys to the corresponding table row data</span>
<span class="sd">        fetched. Each row is represented as a tuple of strings. For</span>
<span class="sd">        example:</span>

<span class="sd">        {b'Serak': ('Rigel VII', 'Preparer'),</span>
<span class="sd">        b'Zim': ('Irk', 'Invader'),</span>
<span class="sd">        b'Lrrr': ('Omicron Persei 8', 'Emperor')}</span>

<span class="sd">        Returned keys are always bytes.  If a key from the keys argument is</span>
<span class="sd">        missing from the dictionary, then that row was not found in the</span>
<span class="sd">        table (and require_all_keys must have been False).</span>

<span class="sd">    Raises:</span>
<span class="sd">        IOError: An error occurred accessing the smalltable.</span>
<span class="sd">    """</span>
</pre></div>
</div>
<p>在 <code class="docutils literal notranslate"><span class="pre">Args:</span></code> 上进行换行也是可以的:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">fetch_smalltable_rows</span><span class="p">(</span><span class="n">table_handle</span><span class="p">:</span> <span class="n">smalltable</span><span class="o">.</span><span class="n">Table</span><span class="p">,</span>
                        <span class="n">keys</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">bytes</span><span class="p">,</span> <span class="nb">str</span><span class="p">]],</span>
                        <span class="n">require_all_keys</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">bytes</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
    <span class="sd">"""Fetches rows from a Smalltable.</span>

<span class="sd">    Retrieves rows pertaining to the given keys from the Table instance</span>
<span class="sd">    represented by table_handle.  String keys will be UTF-8 encoded.</span>

<span class="sd">    Args:</span>
<span class="sd">    table_handle:</span>
<span class="sd">        An open smalltable.Table instance.</span>
<span class="sd">    keys:</span>
<span class="sd">        A sequence of strings representing the key of each table row to</span>
<span class="sd">        fetch.  String keys will be UTF-8 encoded.</span>
<span class="sd">    require_all_keys:</span>
<span class="sd">        Optional; If require_all_keys is True only rows with values set</span>
<span class="sd">        for all keys will be returned.</span>

<span class="sd">    Returns:</span>
<span class="sd">    A dict mapping keys to the corresponding table row data</span>
<span class="sd">    fetched. Each row is represented as a tuple of strings. For</span>
<span class="sd">    example:</span>

<span class="sd">    {b'Serak': ('Rigel VII', 'Preparer'),</span>
<span class="sd">    b'Zim': ('Irk', 'Invader'),</span>
<span class="sd">    b'Lrrr': ('Omicron Persei 8', 'Emperor')}</span>

<span class="sd">    Returned keys are always bytes.  If a key from the keys argument is</span>
<span class="sd">    missing from the dictionary, then that row was not found in the</span>
<span class="sd">    table (and require_all_keys must have been False).</span>

<span class="sd">    Raises:</span>
<span class="sd">    IOError: An error occurred accessing the smalltable.</span>
<span class="sd">    """</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>类</strong></p>
<blockquote>
<div><p>类应该在其定义下有一个用于描述该类的文档字符串. 如果你的类有公共属性(Attributes), 那么文档中应该有一个属性(Attributes)段. 并且应该遵守和函数参数相同的格式.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">SampleClass</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">"""Summary of class here.</span>

<span class="sd">    Longer class information....</span>
<span class="sd">    Longer class information....</span>

<span class="sd">    Attributes:</span>
<span class="sd">        likes_spam: A boolean indicating if we like SPAM or not.</span>
<span class="sd">        eggs: An integer count of the eggs we have laid.</span>
<span class="sd">    """</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">likes_spam</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">"""Inits SampleClass with blah."""</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">likes_spam</span> <span class="o">=</span> <span class="n">likes_spam</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eggs</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">public_method</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">"""Performs operation blah."""</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>块注释和行注释</strong></p>
<blockquote>
<div><p>最需要写注释的是代码中那些技巧性的部分. 如果你在下次 <a class="reference external" href="http://en.wikipedia.org/wiki/Code_review">代码审查</a> 的时候必须解释一下, 那么你应该现在就给它写注释. 对于复杂的操作, 应该在其操作开始前写上若干行注释. 对于不是一目了然的代码, 应在其行尾添加注释.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># We use a weighted dictionary search to find out where i is in</span>
<span class="c1"># the array.  We extrapolate position based on the largest num</span>
<span class="c1"># in the array and the array size and then do binary search to</span>
<span class="c1"># get the exact number.</span>

<span class="k">if</span> <span class="n">i</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>        <span class="c1"># True if i is 0 or a power of 2.</span>
</pre></div>
</div>
<p>为了提高可读性, 注释应该至少离开代码2个空格.</p>
<p>另一方面, 绝不要描述代码. 假设阅读代码的人比你更懂Python, 他只是不知道你的代码要做什么.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># BAD COMMENT: Now go through the b array and make sure whenever i occurs</span>
<span class="c1"># the next element is i+1</span>
</pre></div>
</div>
</div></blockquote>
</section>
<section id="id13">
<h2><span class="section-number">3.10. </span>标点符号,拼写和语法<a class="headerlink" href="#id13" title="永久链接至标题">¶</a></h2>
<div class="admonition tip">
<p class="admonition-title">小技巧</p>
<p>注意标点符号,拼写和语法</p>
<p>注释应有适当的大写和标点,句子应该尽量完整.对于诸如在行尾上的较短注释,可以不那么正式,但是也应该尽量保持风格一致.</p>
</div>
</section>
<section id="id14">
<h2><span class="section-number">3.11. </span>类<a class="headerlink" href="#id14" title="永久链接至标题">¶</a></h2>
<div class="admonition tip">
<p class="admonition-title">小技巧</p>
<p>如果一个类不继承自其它类, 就显式的从object继承. 嵌套类也一样.(除非是为了和 python2 兼容)</p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Yes</span><span class="p">:</span> <span class="k">class</span> <span class="nc">SampleClass</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
         <span class="k">pass</span>


     <span class="k">class</span> <span class="nc">OuterClass</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

         <span class="k">class</span> <span class="nc">InnerClass</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
             <span class="k">pass</span>


     <span class="k">class</span> <span class="nc">ChildClass</span><span class="p">(</span><span class="n">ParentClass</span><span class="p">):</span>
         <span class="sd">"""Explicitly inherits from another class already."""</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">No</span><span class="p">:</span> <span class="k">class</span> <span class="nc">SampleClass</span><span class="p">:</span>
        <span class="k">pass</span>


    <span class="k">class</span> <span class="nc">OuterClass</span><span class="p">:</span>

        <span class="k">class</span> <span class="nc">InnerClass</span><span class="p">:</span>
            <span class="k">pass</span>
</pre></div>
</div>
<p>继承自 <code class="docutils literal notranslate"><span class="pre">object</span></code> 是为了使属性(properties)正常工作, 并且这样可以保护你的代码, 使其不受 <a class="reference external" href="http://www.python.org/dev/peps/pep-3000/">PEP-3000</a> 的一个特殊的潜在不兼容性影响. 这样做也定义了一些特殊的方法, 这些方法实现了对象的默认语义, 包括 <code class="docutils literal notranslate"><span class="pre">__new__,</span> <span class="pre">__init__,</span> <span class="pre">__delattr__,</span> <span class="pre">__getattribute__,</span> <span class="pre">__setattr__,</span> <span class="pre">__hash__,</span> <span class="pre">__repr__,</span> <span class="pre">and</span> <span class="pre">__str__</span></code> .</p>
</section>
<section id="id15">
<h2><span class="section-number">3.12. </span>字符串<a class="headerlink" href="#id15" title="永久链接至标题">¶</a></h2>
<div class="admonition tip">
<p class="admonition-title">小技巧</p>
<p>即使参数都是字符串, 使用%操作符或者格式化方法格式化字符串. 不过也不能一概而论, 你需要在+和%之间好好判定.</p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Yes</span><span class="p">:</span> <span class="n">x</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>
     <span class="n">x</span> <span class="o">=</span> <span class="s1">'</span><span class="si">%s</span><span class="s1">, </span><span class="si">%s</span><span class="s1">!'</span> <span class="o">%</span> <span class="p">(</span><span class="n">imperative</span><span class="p">,</span> <span class="n">expletive</span><span class="p">)</span>
     <span class="n">x</span> <span class="o">=</span> <span class="s1">'</span><span class="si">{}</span><span class="s1">, </span><span class="si">{}</span><span class="s1">!'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">imperative</span><span class="p">,</span> <span class="n">expletive</span><span class="p">)</span>
     <span class="n">x</span> <span class="o">=</span> <span class="s1">'name: </span><span class="si">%s</span><span class="s1">; score: </span><span class="si">%d</span><span class="s1">'</span> <span class="o">%</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
     <span class="n">x</span> <span class="o">=</span> <span class="s1">'name: </span><span class="si">{}</span><span class="s1">; score: </span><span class="si">{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">No</span><span class="p">:</span> <span class="n">x</span> <span class="o">=</span> <span class="s1">'</span><span class="si">%s%s</span><span class="s1">'</span> <span class="o">%</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>  <span class="c1"># use + in this case</span>
    <span class="n">x</span> <span class="o">=</span> <span class="s1">'</span><span class="si">{}{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>  <span class="c1"># use + in this case</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">imperative</span> <span class="o">+</span> <span class="s1">', '</span> <span class="o">+</span> <span class="n">expletive</span> <span class="o">+</span> <span class="s1">'!'</span>
    <span class="n">x</span> <span class="o">=</span> <span class="s1">'name: '</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s1">'; score: '</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</pre></div>
</div>
<p>避免在循环中用+和+=操作符来累加字符串. 由于字符串是不可变的, 这样做会创建不必要的临时对象, 并且导致二次方而不是线性的运行时间. 作为替代方案, 你可以将每个子串加入列表, 然后在循环结束后用 <code class="docutils literal notranslate"><span class="pre">.join</span></code> 连接列表. (也可以将每个子串写入一个 <code class="docutils literal notranslate"><span class="pre">cStringIO.StringIO</span></code> 缓存中.)</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Yes</span><span class="p">:</span> <span class="n">items</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'&lt;table&gt;'</span><span class="p">]</span>
     <span class="k">for</span> <span class="n">last_name</span><span class="p">,</span> <span class="n">first_name</span> <span class="ow">in</span> <span class="n">employee_list</span><span class="p">:</span>
         <span class="n">items</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">'&lt;tr&gt;&lt;td&gt;</span><span class="si">%s</span><span class="s1">, </span><span class="si">%s</span><span class="s1">&lt;/td&gt;&lt;/tr&gt;'</span> <span class="o">%</span> <span class="p">(</span><span class="n">last_name</span><span class="p">,</span> <span class="n">first_name</span><span class="p">))</span>
     <span class="n">items</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">'&lt;/table&gt;'</span><span class="p">)</span>
     <span class="n">employee_table</span> <span class="o">=</span> <span class="s1">''</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">No</span><span class="p">:</span> <span class="n">employee_table</span> <span class="o">=</span> <span class="s1">'&lt;table&gt;'</span>
    <span class="k">for</span> <span class="n">last_name</span><span class="p">,</span> <span class="n">first_name</span> <span class="ow">in</span> <span class="n">employee_list</span><span class="p">:</span>
        <span class="n">employee_table</span> <span class="o">+=</span> <span class="s1">'&lt;tr&gt;&lt;td&gt;</span><span class="si">%s</span><span class="s1">, </span><span class="si">%s</span><span class="s1">&lt;/td&gt;&lt;/tr&gt;'</span> <span class="o">%</span> <span class="p">(</span><span class="n">last_name</span><span class="p">,</span> <span class="n">first_name</span><span class="p">)</span>
    <span class="n">employee_table</span> <span class="o">+=</span> <span class="s1">'&lt;/table&gt;'</span>
</pre></div>
</div>
<p>在同一个文件中, 保持使用字符串引号的一致性. 使用单引号’或者双引号”之一用以引用字符串, 并在同一文件中沿用. 在字符串内可以使用另外一种引号, 以避免在字符串中使用.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Yes</span><span class="p">:</span>
     <span class="n">Python</span><span class="p">(</span><span class="s1">'Why are you hiding your eyes?'</span><span class="p">)</span>
     <span class="n">Gollum</span><span class="p">(</span><span class="s2">"I'm scared of lint errors."</span><span class="p">)</span>
     <span class="n">Narrator</span><span class="p">(</span><span class="s1">'"Good!" thought a happy Python reviewer.'</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">No</span><span class="p">:</span>
     <span class="n">Python</span><span class="p">(</span><span class="s2">"Why are you hiding your eyes?"</span><span class="p">)</span>
     <span class="n">Gollum</span><span class="p">(</span><span class="s1">'The lint. It burns. It burns us.'</span><span class="p">)</span>
     <span class="n">Gollum</span><span class="p">(</span><span class="s2">"Always the great lint. Watching. Watching."</span><span class="p">)</span>
</pre></div>
</div>
<p>为多行字符串使用三重双引号”””而非三重单引号’’’. 当且仅当项目中使用单引号’来引用字符串时, 才可能会使用三重’’’为非文档字符串的多行字符串来标识引用. 文档字符串必须使用三重双引号”””.
多行字符串不应随着代码其他部分缩进的调整而发生位置移动. 如果需要避免在字符串中嵌入额外的空间,可以使用串联的单行字符串或者使用 <a class="reference external" href="https://docs.python.org/zh-cn/3/library/textwrap.html#textwrap.dedent">textwrap.dedent()</a> 来删除每行多余的空间.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">No</span><span class="p">:</span>
<span class="n">long_string</span> <span class="o">=</span> <span class="s2">"""This is pretty ugly.</span>
<span class="s2">Don't do this.</span>
<span class="s2">"""</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Yes</span><span class="p">:</span>
<span class="n">long_string</span> <span class="o">=</span> <span class="s2">"""This is fine if your use case can accept</span>
<span class="s2">  extraneous leading spaces."""</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Yes</span><span class="p">:</span>
<span class="n">long_string</span> <span class="o">=</span> <span class="p">(</span><span class="s2">"And this is fine if you cannot accept</span><span class="se">\n</span><span class="s2">"</span> <span class="o">+</span>
       <span class="s2">"extraneous leading spaces."</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Yes</span><span class="p">:</span>
<span class="n">long_string</span> <span class="o">=</span> <span class="p">(</span><span class="s2">"And this too is fine if you cannot accept</span><span class="se">\n</span><span class="s2">"</span>
       <span class="s2">"extraneous leading spaces."</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Yes</span><span class="p">:</span>
<span class="kn">import</span> <span class="nn">textwrap</span>

<span class="n">long_string</span> <span class="o">=</span> <span class="n">textwrap</span><span class="o">.</span><span class="n">dedent</span><span class="p">(</span><span class="s2">"""</span><span class="se">\</span>
<span class="s2">  This is also fine, because textwrap.dedent()</span>
<span class="s2">  will collapse common leading spaces in each line."""</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="sockets">
<h2><span class="section-number">3.13. </span>文件和sockets<a class="headerlink" href="#sockets" title="永久链接至标题">¶</a></h2>
<div class="admonition tip">
<p class="admonition-title">小技巧</p>
<p>在文件和sockets结束时, 显式的关闭它.</p>
</div>
<p>除文件外, sockets或其他类似文件的对象在没有必要的情况下打开, 会有许多副作用, 例如:</p>
<ol class="arabic simple">
<li><p>它们可能会消耗有限的系统资源, 如文件描述符. 如果这些资源在使用后没有及时归还系统, 那么用于处理这些对象的代码会将资源消耗殆尽.</p></li>
<li><p>持有文件将会阻止对于文件的其他诸如移动、删除之类的操作.</p></li>
<li><p>仅仅是从逻辑上关闭文件和sockets, 那么它们仍然可能会被其共享的程序在无意中进行读或者写操作. 只有当它们真正被关闭后, 对于它们尝试进行读或者写操作将会抛出异常, 并使得问题快速显现出来.</p></li>
</ol>
<p>而且, 幻想当文件对象析构时, 文件和sockets会自动关闭, 试图将文件对象的生命周期和文件的状态绑定在一起的想法, 都是不现实的. 因为有如下原因:</p>
<ol class="arabic simple">
<li><p>没有任何方法可以确保运行环境会真正的执行文件的析构. 不同的Python实现采用不同的内存管理技术, 比如延时垃圾处理机制. 延时垃圾处理机制可能会导致对象生命周期被任意无限制的延长.</p></li>
<li><p>对于文件意外的引用,会导致对于文件的持有时间超出预期(比如对于异常的跟踪, 包含有全局变量等).</p></li>
</ol>
<p>推荐使用 <a class="reference external" href="http://docs.python.org/reference/compound_stmts.html#the-with-statement">“with”语句</a> 以管理文件:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">"hello.txt"</span><span class="p">)</span> <span class="k">as</span> <span class="n">hello_file</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">hello_file</span><span class="p">:</span>
        <span class="nb">print</span> <span class="n">line</span>
</pre></div>
</div>
<p>对于不支持使用”with”语句的类似文件的对象,使用 contextlib.closing():</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">contextlib</span>

<span class="k">with</span> <span class="n">contextlib</span><span class="o">.</span><span class="n">closing</span><span class="p">(</span><span class="n">urllib</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="s2">"http://www.python.org/"</span><span class="p">))</span> <span class="k">as</span> <span class="n">front_page</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">front_page</span><span class="p">:</span>
        <span class="nb">print</span> <span class="n">line</span>
</pre></div>
</div>
<p>Legacy AppEngine 中Python 2.5的代码如使用”with”语句, 需要添加 <code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">__future__</span> <span class="pre">import</span> <span class="pre">with_statement</span></code> .</p>
</section>
<section id="todo">
<h2><span class="section-number">3.14. </span>TODO注释<a class="headerlink" href="#todo" title="永久链接至标题">¶</a></h2>
<div class="admonition tip">
<p class="admonition-title">小技巧</p>
<p>为临时代码使用TODO注释, 它是一种短期解决方案. 不算完美, 但够好了.</p>
</div>
<p>TODO注释应该在所有开头处包含”TODO”字符串, 紧跟着是用括号括起来的你的名字, email地址或其它标识符. 然后是一个可选的冒号. 接着必须有一行注释, 解释要做什么. 主要目的是为了有一个统一的TODO格式, 这样添加注释的人就可以搜索到(并可以按需提供更多细节). 写了TODO注释并不保证写的人会亲自解决问题. 当你写了一个TODO, 请注上你的名字.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># TODO(kl@gmail.com): Use a "*" here for string repetition.</span>
<span class="c1"># TODO(Zeke) Change this to use relations.</span>
</pre></div>
</div>
<p>如果你的TODO是”将来做某事”的形式, 那么请确保你包含了一个指定的日期(“2009年11月解决”)或者一个特定的事件(“等到所有的客户都可以处理XML请求就移除这些代码”).</p>
</section>
<section id="id16">
<h2><span class="section-number">3.15. </span>导入格式<a class="headerlink" href="#id16" title="永久链接至标题">¶</a></h2>
<div class="admonition tip">
<p class="admonition-title">小技巧</p>
<p>每个导入应该独占一行, <code class="docutils literal notranslate"><span class="pre">typing</span></code> 的导入除外</p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Yes</span><span class="p">:</span> <span class="kn">import</span> <span class="nn">os</span>
    <span class="kn">import</span> <span class="nn">sys</span>
    <span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Mapping</span><span class="p">,</span> <span class="n">Sequence</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">No</span><span class="p">:</span>  <span class="kn">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">sys</span>
</pre></div>
</div>
<p>导入总应该放在文件顶部, 位于模块注释和文档字符串之后, 模块全局变量和常量之前.  导入应该按照从最通用到最不通用的顺序分组:</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">__future__</span></code> 导入</p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">absolute_import</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>
</pre></div>
</div>
<ol class="arabic simple">
<li><p>标准库导入</p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
</pre></div>
</div>
<ol class="arabic simple">
<li><p>第三方库导入</p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
</pre></div>
</div>
<ol class="arabic simple">
<li><p>本地代码子包导入</p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">otherproject.ai</span> <span class="kn">import</span> <span class="n">mind</span>
</pre></div>
</div>
<p>每种分组中,  应该根据每个模块的完整包路径按字典序排序, 忽略大小写.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">collections</span>
<span class="kn">import</span> <span class="nn">queue</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="kn">from</span> <span class="nn">absl</span> <span class="kn">import</span> <span class="n">app</span>
<span class="kn">from</span> <span class="nn">absl</span> <span class="kn">import</span> <span class="n">flags</span>
<span class="kn">import</span> <span class="nn">bs4</span>
<span class="kn">import</span> <span class="nn">cryptography</span>
<span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>

<span class="kn">from</span> <span class="nn">book.genres</span> <span class="kn">import</span> <span class="n">scifi</span>
<span class="kn">from</span> <span class="nn">myproject.backend</span> <span class="kn">import</span> <span class="n">huxley</span>
<span class="kn">from</span> <span class="nn">myproject.backend.hgwells</span> <span class="kn">import</span> <span class="n">time_machine</span>
<span class="kn">from</span> <span class="nn">myproject.backend.state_machine</span> <span class="kn">import</span> <span class="n">main_loop</span>
<span class="kn">from</span> <span class="nn">otherproject.ai</span> <span class="kn">import</span> <span class="n">body</span>
<span class="kn">from</span> <span class="nn">otherproject.ai</span> <span class="kn">import</span> <span class="n">mind</span>
<span class="kn">from</span> <span class="nn">otherproject.ai</span> <span class="kn">import</span> <span class="n">soul</span>

<span class="c1"># Older style code may have these imports down here instead:</span>
<span class="c1">#from myproject.backend.hgwells import time_machine</span>
<span class="c1">#from myproject.backend.state_machine import main_loop</span>
</pre></div>
</div>
</section>
<section id="id17">
<h2><span class="section-number">3.16. </span>语句<a class="headerlink" href="#id17" title="永久链接至标题">¶</a></h2>
<div class="admonition tip">
<p class="admonition-title">小技巧</p>
<p>通常每个语句应该独占一行</p>
</div>
<p>不过, 如果测试结果与测试语句在一行放得下, 你也可以将它们放在同一行.  如果是if语句, 只有在没有else时才能这样做. 特别地, 绝不要对 <code class="docutils literal notranslate"><span class="pre">try/except</span></code> 这样做, 因为try和except不能放在同一行.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Yes</span><span class="p">:</span>

  <span class="k">if</span> <span class="n">foo</span><span class="p">:</span> <span class="n">bar</span><span class="p">(</span><span class="n">foo</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">No</span><span class="p">:</span>

  <span class="k">if</span> <span class="n">foo</span><span class="p">:</span> <span class="n">bar</span><span class="p">(</span><span class="n">foo</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>   <span class="n">baz</span><span class="p">(</span><span class="n">foo</span><span class="p">)</span>

  <span class="k">try</span><span class="p">:</span>               <span class="n">bar</span><span class="p">(</span><span class="n">foo</span><span class="p">)</span>
  <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span> <span class="n">baz</span><span class="p">(</span><span class="n">foo</span><span class="p">)</span>

  <span class="k">try</span><span class="p">:</span>
      <span class="n">bar</span><span class="p">(</span><span class="n">foo</span><span class="p">)</span>
  <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span> <span class="n">baz</span><span class="p">(</span><span class="n">foo</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id18">
<h2><span class="section-number">3.17. </span>访问控制<a class="headerlink" href="#id18" title="永久链接至标题">¶</a></h2>
<div class="admonition tip">
<p class="admonition-title">小技巧</p>
<p>在Python中, 对于琐碎又不太重要的访问函数, 你应该直接使用公有变量来取代它们, 这样可以避免额外的函数调用开销. 当添加更多功能时, 你可以用属性(property)来保持语法的一致性.</p>
<p>(译者注: 重视封装的面向对象程序员看到这个可能会很反感, 因为他们一直被教育: 所有成员变量都必须是私有的! 其实, 那真的是有点麻烦啊. 试着去接受Pythonic哲学吧)</p>
</div>
<p>另一方面, 如果访问更复杂, 或者变量的访问开销很显著, 那么你应该使用像 <code class="docutils literal notranslate"><span class="pre">get_foo()</span></code> 和 <code class="docutils literal notranslate"><span class="pre">set_foo()</span></code> 这样的函数调用. 如果之前的代码行为允许通过属性(property)访问 , 那么就不要将新的访问函数与属性绑定. 这样, 任何试图通过老方法访问变量的代码就没法运行, 使用者也就会意识到复杂性发生了变化.</p>
</section>
<section id="s3-16-naming">
<span id="id19"></span><h2><span class="section-number">3.18. </span>命名<a class="headerlink" href="#s3-16-naming" title="永久链接至标题">¶</a></h2>
<div class="admonition tip">
<p class="admonition-title">小技巧</p>
<p>模块名写法: <code class="docutils literal notranslate"><span class="pre">module_name</span></code> ;包名写法: <code class="docutils literal notranslate"><span class="pre">package_name</span></code> ;类名: <code class="docutils literal notranslate"><span class="pre">ClassName</span></code> ;方法名: <code class="docutils literal notranslate"><span class="pre">method_name</span></code> ;异常名: <code class="docutils literal notranslate"><span class="pre">ExceptionName</span></code> ;函数名: <code class="docutils literal notranslate"><span class="pre">function_name</span></code> ;全局常量名: <code class="docutils literal notranslate"><span class="pre">GLOBAL_CONSTANT_NAME</span></code> ;全局变量名: <code class="docutils literal notranslate"><span class="pre">global_var_name</span></code> ;实例名: <code class="docutils literal notranslate"><span class="pre">instance_var_name</span></code> ;函数参数名: <code class="docutils literal notranslate"><span class="pre">function_parameter_name</span></code> ;局部变量名: <code class="docutils literal notranslate"><span class="pre">local_var_name</span></code> .
函数名,变量名和文件名应该是描述性的,尽量避免缩写,特别要避免使用非项目人员不清楚难以理解的缩写,不要通过删除单词中的字母来进行缩写.
始终使用 <code class="docutils literal notranslate"><span class="pre">.py</span></code> 作为文件后缀名,不要用破折号.</p>
</div>
<p><strong>应该避免的名称</strong></p>
<blockquote>
<div><ol class="arabic simple">
<li><p>单字符名称, 除了计数器和迭代器,作为 <code class="docutils literal notranslate"><span class="pre">try/except</span></code> 中异常声明的 <code class="docutils literal notranslate"><span class="pre">e</span></code>,作为 <code class="docutils literal notranslate"><span class="pre">with</span></code> 语句中文件句柄的 <code class="docutils literal notranslate"><span class="pre">f</span></code>.</p></li>
<li><p>包/模块名中的连字符(-)</p></li>
<li><p>双下划线开头并结尾的名称(Python保留, 例如__init__)</p></li>
</ol>
</div></blockquote>
<p><strong>命名约定</strong></p>
<blockquote>
<div><ol class="arabic simple">
<li><p>所谓”内部(Internal)”表示仅模块内可用, 或者, 在类内是保护或私有的.</p></li>
<li><p>用单下划线(_)开头表示模块变量或函数是protected的(使用from module import *时不会包含).</p></li>
<li><p>用双下划线(__)开头的实例变量或方法表示类内私有.</p></li>
<li><p>将相关的类和顶级函数放在同一个模块里. 不像Java, 没必要限制一个类一个模块.</p></li>
<li><p>对类名使用大写字母开头的单词(如CapWords, 即Pascal风格), 但是模块名应该用小写加下划线的方式(如lower_with_under.py). 尽管已经有很多现存的模块使用类似于CapWords.py这样的命名, 但现在已经不鼓励这样做, 因为如果模块名碰巧和类名一致, 这会让人困扰.</p></li>
</ol>
</div></blockquote>
<p><strong>文件名</strong></p>
<blockquote>
<div><p>所有python脚本文件都应该以 <code class="docutils literal notranslate"><span class="pre">.py</span></code> 为后缀名且不包含 <code class="docutils literal notranslate"><span class="pre">-</span></code>.若是需要一个无后缀名的可执行文件,可以使用软联接或者包含 <code class="docutils literal notranslate"><span class="pre">exec</span> <span class="pre">"$0.py"</span> <span class="pre">"$@"</span></code> 的bash脚本.</p>
</div></blockquote>
<p><strong>Python之父Guido推荐的规范</strong></p>
<div class="table-wrapper"><table class="docutils align-default">
<colgroup>
<col style="width: 23%"/>
<col style="width: 17%"/>
<col style="width: 60%"/>
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Type</p></th>
<th class="head"><p>Public</p></th>
<th class="head"><p>Internal</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Modules</p></td>
<td><p>lower_with_under</p></td>
<td><p>_lower_with_under</p></td>
</tr>
<tr class="row-odd"><td><p>Packages</p></td>
<td><p>lower_with_under</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>Classes</p></td>
<td><p>CapWords</p></td>
<td><p>_CapWords</p></td>
</tr>
<tr class="row-odd"><td><p>Exceptions</p></td>
<td><p>CapWords</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>Functions</p></td>
<td><p>lower_with_under()</p></td>
<td><p>_lower_with_under()</p></td>
</tr>
<tr class="row-odd"><td><p>Global/Class Constants</p></td>
<td><p>CAPS_WITH_UNDER</p></td>
<td><p>_CAPS_WITH_UNDER</p></td>
</tr>
<tr class="row-even"><td><p>Global/Class Variables</p></td>
<td><p>lower_with_under</p></td>
<td><p>_lower_with_under</p></td>
</tr>
<tr class="row-odd"><td><p>Instance Variables</p></td>
<td><p>lower_with_under</p></td>
<td><p>_lower_with_under (protected) or __lower_with_under (private)</p></td>
</tr>
<tr class="row-even"><td><p>Method Names</p></td>
<td><p>lower_with_under()</p></td>
<td><p>_lower_with_under() (protected) or __lower_with_under() (private)</p></td>
</tr>
<tr class="row-odd"><td><p>Function/Method Parameters</p></td>
<td><p>lower_with_under</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>Local Variables</p></td>
<td><p>lower_with_under</p></td>
<td></td>
</tr>
</tbody>
</table></div>
</section>
<section id="main">
<span id="id20"></span><h2><span class="section-number">3.19. </span>Main<a class="headerlink" href="#main" title="永久链接至标题">¶</a></h2>
<div class="admonition tip">
<p class="admonition-title">小技巧</p>
<p>即使是一个打算被用作脚本的文件, 也应该是可导入的. 并且简单的导入不应该导致这个脚本的主功能(main functionality)被执行, 这是一种副作用. 主功能应该放在一个main()函数中.</p>
</div>
<p>在Python中, pydoc以及单元测试要求模块必须是可导入的. 你的代码应该在执行主程序前总是检查 <code class="docutils literal notranslate"><span class="pre">if</span> <span class="pre">__name__</span> <span class="pre">==</span> <span class="pre">'__main__'</span></code> , 这样当模块被导入时主程序就不会被执行.</p>
<p>若使用 <a class="reference external" href="https://github.com/abseil/abseil-py">absl</a>, 请使用 <code class="docutils literal notranslate"><span class="pre">app.run</span></code> :</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">absl</span> <span class="kn">import</span> <span class="n">app</span>
<span class="o">...</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="n">argv</span><span class="p">):</span>
    <span class="c1"># process non-flag arguments</span>
    <span class="o">...</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">'__main__'</span><span class="p">:</span>
    <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">main</span><span class="p">)</span>
</pre></div>
</div>
<p>否则,使用:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="o">...</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">'__main__'</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
<p>所有的顶级代码在模块导入时都会被执行. 要小心不要去调用函数, 创建对象, 或者执行那些不应该在使用pydoc时执行的操作.</p>
</section>
<section id="id21">
<h2><span class="section-number">3.20. </span>函数长度<a class="headerlink" href="#id21" title="永久链接至标题">¶</a></h2>
<div class="admonition tip">
<p class="admonition-title">小技巧</p>
<p>推荐函数功能尽量集中,简单,小巧</p>
</div>
<p>不对函数长度做硬性限制.但是若一个函数超过来40行,推荐考虑一下是否可以在不损害程序结构的情况下对其进行分解.
因为即使现在长函数运行良好,但几个月后可能会有人修改它并添加一些新的行为,这容易产生难以发现的bug.保持函数的简练,使其更加容易阅读和修改.
当遇到一些很长的函数时,若发现调试比较困难或是想在其他地方使用函数的一部分功能,不妨考虑将这个场函数进行拆分.</p>
</section>
<section id="id22">
<h2><span class="section-number">3.21. </span>类型注释<a class="headerlink" href="#id22" title="永久链接至标题">¶</a></h2>
<p><strong>通用规则</strong></p>
<blockquote>
<div><ol class="arabic simple">
<li><p>请先熟悉下 ‘PEP-484 &lt;<a class="reference external" href="https://www.python.org/dev/peps/pep-0484/">https://www.python.org/dev/peps/pep-0484/</a>&gt;’_</p></li>
<li><p>对于方法，仅在必要时才对 <code class="docutils literal notranslate"><span class="pre">self</span></code> 或 <code class="docutils literal notranslate"><span class="pre">cls</span></code> 注释</p></li>
<li><p>若对类型没有任何显示，请使用 <code class="docutils literal notranslate"><span class="pre">Any</span></code></p></li>
<li><dl class="simple">
<dt>无需注释模块中的所有函数</dt><dd><ol class="arabic simple">
<li><p>公共的API需要注释</p></li>
<li><p>在代码的安全性，清晰性和灵活性上进行权衡是否注释</p></li>
<li><p>对于容易出现类型相关的错误的代码进行注释</p></li>
<li><p>难以理解的代码请进行注释</p></li>
<li><p>若代码中的类型已经稳定，可以进行注释. 对于一份成熟的代码，多数情况下，即使注释了所有的函数，也不会丧失太多的灵活性.</p></li>
</ol>
</dd>
</dl>
</li>
</ol>
</div></blockquote>
<p><strong>换行</strong></p>
<blockquote>
<div><p>尽量遵守既定的缩进规则.注释后，很多函数签名将会变成每行一个参数.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">my_method</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
              <span class="n">first_var</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
              <span class="n">second_var</span><span class="p">:</span> <span class="n">Foo</span><span class="p">,</span>
              <span class="n">third_var</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Bar</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="o">...</span>
</pre></div>
</div>
<p>尽量在变量之间换行而不是在变量和类型注释之间.当然,若所有东西都在一行上,也可以接受.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">my_method</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">first_var</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="o">...</span>
</pre></div>
</div>
<p>若是函数名,末位形参和返回值的类型注释太长,也可以进行换行,并在新行进行4格缩进.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">my_method</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">first_var</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">MyLongType1</span><span class="p">,</span> <span class="n">MyLongType1</span><span class="p">]:</span>
<span class="o">...</span>
</pre></div>
</div>
<p>若是末位形参和返回值类型注释不适合在同一行上,可以换行,缩进为4空格,并保持闭合的括号 <code class="docutils literal notranslate"><span class="pre">)</span></code> 和 <code class="docutils literal notranslate"><span class="pre">def</span></code> 对齐</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Yes</span><span class="p">:</span>
<span class="k">def</span> <span class="nf">my_method</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">other_arg</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">MyLongType</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="n">OtherLongType</span><span class="p">,</span> <span class="n">MyLongType</span><span class="p">]:</span>
<span class="o">...</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">pylint</span></code> 允许闭合括号 <code class="docutils literal notranslate"><span class="pre">)</span></code> 换至新行并与 开启括号 <code class="docutils literal notranslate"><span class="pre">(</span></code> 对齐,但这样的可读性不好.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">No</span><span class="p">:</span>
<span class="k">def</span> <span class="nf">my_method</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                <span class="n">other_arg</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">MyLongType</span><span class="p">]</span>
             <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="n">OtherLongType</span><span class="p">,</span> <span class="n">MyLongType</span><span class="p">]:</span>
<span class="o">...</span>
</pre></div>
</div>
<p>如上所示,尽量不要在一个类型注释中进行换行.但是有时类型注释过长需要换行时,请尽量保持子类型中不被换行.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">my_method</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">first_var</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">MyLongType1</span><span class="p">],</span>
                     <span class="n">List</span><span class="p">[</span><span class="n">MyLongType2</span><span class="p">]],</span>
    <span class="n">second_var</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span>
        <span class="n">MyLongType3</span><span class="p">,</span> <span class="n">MyLongType4</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="o">...</span>
</pre></div>
</div>
<p>若一个类型注释确实太长,则应优先考虑对过长的类型使用别名 <a class="reference external" href="typing-aliases">alias</a> 。 其次是考虑在冒号后 <code class="docutils literal notranslate"><span class="pre">:</span></code> 进行换行并添加4格空格缩进。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Yes</span><span class="p">:</span>
<span class="k">def</span> <span class="nf">my_function</span><span class="p">(</span>
    <span class="n">long_variable_name</span><span class="p">:</span>
        <span class="n">long_module_name</span><span class="o">.</span><span class="n">LongTypeName</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="o">...</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">No</span><span class="p">:</span>
<span class="k">def</span> <span class="nf">my_function</span><span class="p">(</span>
    <span class="n">long_variable_name</span><span class="p">:</span> <span class="n">long_module_name</span><span class="o">.</span>
        <span class="n">LongTypeName</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="o">...</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>预先声明</strong></p>
<blockquote>
<div><p>若需要使用一个当前模块尚未定义的类名,比如想在类声明中使用类名,请使用类名的字符串</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyClass</span><span class="p">:</span>

  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
               <span class="n">stack</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="s2">"MyClass"</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>参数默认值</strong></p>
<blockquote>
<div><p>依据 <a class="reference external" href="https://www.python.org/dev/peps/pep-0008/#other-recommendations">PEP-008</a> ,仅对同时具有类型注释和默认值的参数的 <code class="docutils literal notranslate"><span class="pre">=</span></code> 周围加空格.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Yes</span><span class="p">:</span>
<span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="o">...</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">No</span><span class="p">:</span>
<span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">a</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="o">...</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>NoneType</strong></p>
<blockquote>
<div><p>在python的类型系统中, <code class="docutils literal notranslate"><span class="pre">NoneType</span></code> 是 “一等对象”,为了输入方便, <code class="docutils literal notranslate"><span class="pre">None</span></code> 是 <code class="docutils literal notranslate"><span class="pre">NoneType</span></code> 的别名.一个变量若是 <code class="docutils literal notranslate"><span class="pre">None</span></code>,则该变量必须被声明.我们可以使用 <code class="docutils literal notranslate"><span class="pre">Union</span></code>, 但若类型仅仅只是对应另一个其他类型,建议使用 <code class="docutils literal notranslate"><span class="pre">Optional</span></code>.
尽量显式而非隐式的使用 <code class="docutils literal notranslate"><span class="pre">Optional</span></code>.在PEP-484的早期版本中允许使用 <code class="docutils literal notranslate"><span class="pre">a:</span> <span class="pre">Text</span> <span class="pre">=</span> <span class="pre">None</span></code> 来替代 <code class="docutils literal notranslate"><span class="pre">a:</span> <span class="pre">Optional[Text]</span> <span class="pre">=</span> <span class="pre">None</span></code>,当然,现在不推荐这么做了.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Yes</span><span class="p">:</span>
<span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Text</span><span class="p">],</span> <span class="n">b</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Text</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Text</span><span class="p">:</span>
    <span class="o">...</span>
<span class="k">def</span> <span class="nf">multiple_nullable_union</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="n">Text</span><span class="p">,</span> <span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Text</span>
    <span class="o">...</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">No</span><span class="p">:</span>
<span class="k">def</span> <span class="nf">nullable_union</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="n">Text</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Text</span><span class="p">:</span>
    <span class="o">...</span>
<span class="k">def</span> <span class="nf">implicit_optional</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="n">Text</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Text</span><span class="p">:</span>
    <span class="o">...</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>类型别名</strong></p>
<blockquote>
<div><p>复杂类型应使用别名,别名的命名可参照帕斯卡命名.若别名仅在当前模块使用,应在名称前加``_``变为私有的.
如下例子中,模块名和类型名连一起过长:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">_ShortName</span> <span class="o">=</span> <span class="n">module_with_long_name</span><span class="o">.</span><span class="n">TypeWithLongName</span>
<span class="n">ComplexMap</span> <span class="o">=</span> <span class="n">Mapping</span><span class="p">[</span><span class="n">Text</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]]</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>忽略类型注释</strong></p>
<blockquote>
<div><p>可以使用特殊的行尾注释 <code class="docutils literal notranslate"><span class="pre">#</span> <span class="pre">type:</span> <span class="pre">ignore</span></code> 来禁用该行的类型检查.
<code class="docutils literal notranslate"><span class="pre">pytype</span></code> 针对特定错误有一个禁用选项(类似lint):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># pytype: disable=attribute-error</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>变量类型注解</strong></p>
<blockquote>
<div><p>当一个内部变量难以推断其类型时,可以有以下方法来指示其类型:</p>
<p><strong>类型注释</strong></p>
<p>使用行尾注释 <code class="docutils literal notranslate"><span class="pre">#</span> <span class="pre">type:</span></code>:</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">SomeUndecoratedFunction</span><span class="p">()</span>  <span class="c1"># type: Foo</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>带类型注解的复制</strong>
如函数形参一样,在变量名和等号间加入冒号和类型:</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="p">:</span> <span class="n">Foo</span> <span class="o">=</span> <span class="n">SomeUndecoratedFunction</span><span class="p">()</span>
</pre></div>
</div>
</div></blockquote>
</div></blockquote>
<p><strong>Tuples vs Lists</strong></p>
<blockquote>
<div><p>类型化的Lists只能包含单一类型的元素.但类型化的Tuples可以包含单一类型的元素或者若干个不同类型的元素,通常被用来注解返回值的类型.
(译者注: 注意这里是指的类型注解中的写法,实际python中,list和tuple都是可以在一个序列中包含不同类型元素的,当然,本质其实list和tuple中放的是元素的引用)</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>  <span class="c1"># type: List[int]</span>
<span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>  <span class="c1"># type: Tuple[int, ...]</span>
<span class="n">c</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s2">"2"</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">)</span>  <span class="c1"># type: Tuple[int, Text, float]</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>TypeVars</strong></p>
<blockquote>
<div><p>python的类型系统是支持泛型的.一种常见的方式就是使用工厂函数 <code class="docutils literal notranslate"><span class="pre">TypeVars</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">TypeVar</span>
<span class="n">T</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s2">"T"</span><span class="p">)</span>
<span class="o">...</span>
<span class="k">def</span> <span class="nf">next</span><span class="p">(</span><span class="n">l</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">T</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">l</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
</pre></div>
</div>
<p>TypeVar也可以被限定成若干种类型</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">AddableType</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s2">"AddableType"</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="n">Text</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="n">AddableType</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">AddableType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AddableType</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">typing</span></code> 模块中一个常见的预定义类型变量是 <code class="docutils literal notranslate"><span class="pre">AnyStr</span></code>.它可以用来注解类似 <code class="docutils literal notranslate"><span class="pre">bytes</span></code>, <code class="docutils literal notranslate"><span class="pre">unicode</span></code> 以及一些相似类型.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">AnyStr</span>
<span class="k">def</span> <span class="nf">check_length</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">AnyStr</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AnyStr</span><span class="p">:</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">42</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">x</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">()</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>字符串类型</strong></p>
<blockquote>
<div><p>如何正确的注释字符串的相关类型和要使用的python版本有关.
对于仅在 python3 下运行的代码,首选使用 <code class="docutils literal notranslate"><span class="pre">str</span></code>. 使用 <code class="docutils literal notranslate"><span class="pre">Text</span></code> 也可以.但是两个不要混用,保持风格一致.
对于需要兼容 python2 的代码,使用 <code class="docutils literal notranslate"><span class="pre">Text</span></code>.在少数情况下,使用 <code class="docutils literal notranslate"><span class="pre">str</span></code> 也许更加清晰.不要使用 <code class="docutils literal notranslate"><span class="pre">unicode</span></code>,因为 python3 里没有这个类型.
造成这种差异的原因是因为,在不同的python版本中,``str`` 意义不同.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">No</span><span class="p">:</span>
<span class="k">def</span> <span class="nf">py2_code</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">unicode</span><span class="p">:</span>
<span class="o">...</span>
</pre></div>
</div>
<p>对于需要处理二进制数据的代码,使用 <code class="docutils literal notranslate"><span class="pre">bytes</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">deals_with_binary_data</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
  <span class="o">...</span>
</pre></div>
</div>
<p>python2 中的文本类数据类型包括``str``和``unicode``,而python3 中仅有 <code class="docutils literal notranslate"><span class="pre">str</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Text</span>
<span class="o">...</span>
<span class="k">def</span> <span class="nf">py2_compatible</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">Text</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Text</span><span class="p">:</span>
<span class="o">...</span>
<span class="k">def</span> <span class="nf">py3_only</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="o">...</span>
</pre></div>
</div>
<p>若类型既可以是二进制也可以是文本,那么就使用 <code class="docutils literal notranslate"><span class="pre">Union</span></code> 进行注解,并按照之前规则使用合适的文本类型注释.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Text</span><span class="p">,</span> <span class="n">Union</span>
<span class="o">...</span>
<span class="k">def</span> <span class="nf">py2_compatible</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bytes</span><span class="p">,</span> <span class="n">Text</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bytes</span><span class="p">,</span> <span class="n">Text</span><span class="p">]:</span>
<span class="o">...</span>
<span class="k">def</span> <span class="nf">py3_only</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bytes</span><span class="p">,</span> <span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bytes</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<span class="o">...</span>
</pre></div>
</div>
<p>若一个函数中的字符串类型始终相同,比如上述函数中返回值类型和形参类型都一样,使用 <a class="reference external" href="https://google.github.io/styleguide/pyguide.html#typing-type-var">AnyStr</a>.
这样写可以方便将代码移植到 python3</p>
</div></blockquote>
<p><strong>类型的导入</strong></p>
<blockquote>
<div><p>对于 <code class="docutils literal notranslate"><span class="pre">typing</span></code> 模块中类的导入,请直接导入类本身.你可以显式的在一行中从 <code class="docutils literal notranslate"><span class="pre">typing</span></code> 模块导入多个特定的类,例如:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Optional</span>
</pre></div>
</div>
<p>以此方式导入的类将被加入到本地的命名空间,因此所有 <code class="docutils literal notranslate"><span class="pre">typing</span></code> 模块中的类都应被视为关键字,不要在代码中定义并覆盖它们.若这些类和现行代码中的变量或者方法发生命名冲突,可以考虑使用 <code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">x</span> <span class="pre">as</span> <span class="pre">y</span></code> 的导入形式：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Any</span> <span class="k">as</span> <span class="n">AnyType</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>条件导入</strong></p>
<blockquote>
<div><p>在一些特殊情况下,比如当在运行时需要避免类型检查所需的一些导入时,可能会用到条件导入.但这类方法并不推荐,首选方法应是重构代码使类型检查所需的模块可以在顶层导入.
仅用于类型注解的导入可以放在 <code class="docutils literal notranslate"><span class="pre">if</span> <span class="pre">TYPE_CHECKING:</span></code> 语句块内.</p>
<ol class="arabic simple">
<li><p>通过条件导入引入的类的注解须是字符串string,这样才能和python3.6之前的代码兼容.因为python3.6之前,类型注解是会进行求值的.</p></li>
<li><p>条件导入引入的包应仅仅用于类型注解,别名也是如此.否则,将引起运行错误,条件导入的包在运行时是不会被实际导入的.</p></li>
<li><p>条件导入的语句块应放在所有常规导入的语句块之后.</p></li>
<li><p>在条件导入的语句块的导入语句之间不应有空行.</p></li>
<li><p>和常规导入一样,请对该导入语句进行排序.</p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">typing</span>
<span class="k">if</span> <span class="n">typing</span><span class="o">.</span><span class="n">TYPE_CHECKING</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">sketch</span>
<span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="s2">"sketch.Sketch"</span><span class="p">):</span> <span class="o">...</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>循环依赖</strong></p>
<blockquote>
<div><p>由类型注释引起的循环依赖可能会导致代码异味,应对其进行重构.虽然从技术上我们可以兼容循环依赖,但是 <a class="reference external" href="https://google.github.io/styleguide/pyguide.html#typing-build-deps">构建系统</a> 是不会容忍这样做的,因为每个模块都需要依赖一个其他模块.
将引起循环依赖的导入模块使用 <code class="docutils literal notranslate"><span class="pre">Any</span></code> 导入.使用 <code class="docutils literal notranslate"><span class="pre">alias</span></code> 来起一个有意义的别名,推荐使用真正模块的类型名的字符串作为别名(Any的任何属性依然是Any,使用字符串只是帮助我们理解代码).别名的定义应该和最后的导入语句之间空一行.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Any</span>

<span class="n">some_mod</span> <span class="o">=</span> <span class="n">Any</span>  <span class="c1"># some_mod.py imports this module.</span>
<span class="o">...</span>

<span class="k">def</span> <span class="nf">my_method</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">var</span><span class="p">:</span> <span class="s2">"some_mod.SomeType"</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="o">...</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>泛型</strong></p>
<blockquote>
<div><p>在注释时,尽量将泛型类型注释为类型参数.否则, <a class="reference external" href="https://www.python.org/dev/peps/pep-0484/#the-any-type">泛型参数将被视为是 Any</a> .</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_names</span><span class="p">(</span><span class="n">employee_ids</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="o">...</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># These are both interpreted as get_names(employee_ids: List[Any]) -&gt; Dict[Any, Any]</span>
<span class="k">def</span> <span class="nf">get_names</span><span class="p">(</span><span class="n">employee_ids</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
<span class="o">...</span>

<span class="k">def</span> <span class="nf">get_names</span><span class="p">(</span><span class="n">employee_ids</span><span class="p">:</span> <span class="n">List</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
<span class="o">...</span>
</pre></div>
</div>
<p>若实在要用 Any 作为泛型类型,请显式的使用它.但在多数情况下, <code class="docutils literal notranslate"><span class="pre">TypeVar</span></code> 通常可能是更好的选择.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_names</span><span class="p">(</span><span class="n">employee_ids</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Text</span><span class="p">]:</span>
    <span class="sd">"""Returns a mapping from employee ID to employee name for given IDs."""</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">T</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s1">'T'</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">get_names</span><span class="p">(</span><span class="n">employee_ids</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">T</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="n">T</span><span class="p">,</span> <span class="n">Text</span><span class="p">]:</span>
    <span class="sd">"""Returns a mapping from employee ID to employee name for given IDs."""</span>
</pre></div>
</div>
</div></blockquote>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="parting_words.html">
              <div class="page-info">
                <div class="context">
                  <span>下一页</span>
                </div>
                <div class="title"><span class="section-number">4. </span>临别赠言</div>
              </div>
              <svg><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="python_language_rules.html">
              <svg><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>上一页</span>
                </div>
                
                <div class="title"><span class="section-number">2. </span>Python语言规范</div>
                
              </div>
            </a>
        </div>

        <div class="related-information">
              Copyright &#169; 2021, xinetzone |
          Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
          <a href="https://github.com/pradyunsg/furo">Furo theme</a>.
            | <a class="muted-link" href="../../_sources/google/python/python_style_rules.rst.txt"
               rel="nofollow">
              显示源代码
            </a>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            目录
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">3. Python 风格规范</a><ul>
<li><a class="reference internal" href="#id1">3.1. 分号</a></li>
<li><a class="reference internal" href="#line-length">3.2. 行长度</a></li>
<li><a class="reference internal" href="#id5">3.3. 括号</a></li>
<li><a class="reference internal" href="#indentation">3.4. 缩进</a></li>
<li><a class="reference internal" href="#id7">3.5. 序列元素尾部逗号</a></li>
<li><a class="reference internal" href="#id8">3.6. 空行</a></li>
<li><a class="reference internal" href="#id9">3.7. 空格</a></li>
<li><a class="reference internal" href="#shebang">3.8. Shebang</a></li>
<li><a class="reference internal" href="#comments">3.9. 注释</a></li>
<li><a class="reference internal" href="#id13">3.10. 标点符号,拼写和语法</a></li>
<li><a class="reference internal" href="#id14">3.11. 类</a></li>
<li><a class="reference internal" href="#id15">3.12. 字符串</a></li>
<li><a class="reference internal" href="#sockets">3.13. 文件和sockets</a></li>
<li><a class="reference internal" href="#todo">3.14. TODO注释</a></li>
<li><a class="reference internal" href="#id16">3.15. 导入格式</a></li>
<li><a class="reference internal" href="#id17">3.16. 语句</a></li>
<li><a class="reference internal" href="#id18">3.17. 访问控制</a></li>
<li><a class="reference internal" href="#s3-16-naming">3.18. 命名</a></li>
<li><a class="reference internal" href="#main">3.19. Main</a></li>
<li><a class="reference internal" href="#id21">3.20. 函数长度</a></li>
<li><a class="reference internal" href="#id22">3.21. 类型注释</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/scripts/furo.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/tabs.js"></script>
    <script src="../../_static/translations.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    </body>
</html>